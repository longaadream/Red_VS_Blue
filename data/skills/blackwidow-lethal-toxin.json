{
  "id": "blackwidow-lethal-toxin",
  "name": "致命毒素",
  "description": "在自己当前的格子放置一个毒素，选择距离3以内未被占用的格子并移动到该格子，敌人碰到毒素时受到4点伤害。",
  "icon": "☠️",
  "kind": "active",
  "type": "normal",
  "cooldownTurns": 2,
  "maxCharges": 0,
  "powerMultiplier": 1,
  "actionPointCost": 2,
  "code": "function executeSkill(context) { var caster = context.piece; var battle = context.battle; console.log('[LethalToxin] Starting, caster:', caster.name, 'at', caster.x, caster.y); var targetPos = selectTarget({ type: 'grid', range: 3, filter: 'all' }); if (!targetPos || targetPos.needsTargetSelection) { return targetPos; } var newX = targetPos.x; var newY = targetPos.y; var tile = battle.map.tiles.find(function(t) { return t.x === newX && t.y === newY; }); if (!tile || !tile.props.walkable) { return { success: false, message: '目标位置不可行走' }; } var occupied = battle.pieces.some(function(p) { return p.x === newX && p.y === newY && p.currentHp > 0; }); if (occupied) { return { success: false, message: '目标位置已被占用' }; } var toxinX = caster.x; var toxinY = caster.y; console.log('[LethalToxin] Placing toxin at:', toxinX, toxinY); console.log('[LethalToxin] Moving to:', newX, newY); if (!battle.toxins) { battle.toxins = []; } battle.toxins.push({ x: toxinX, y: toxinY, damage: 4, casterOwnerId: caster.ownerPlayerId }); console.log('[LethalToxin] Added toxin to battle.toxins, total:', battle.toxins.length); caster.x = newX; caster.y = newY; console.log('[LethalToxin] Moved, new position:', caster.x, caster.y); return { success: true, message: caster.name + '在原位置(' + toxinX + ',' + toxinY + ')放置了毒素，并移动到了(' + newX + ',' + newY + ')' }; }",
  "previewCode": "function calculatePreview(piece, skillDef) { return { description: '在当前格子放置毒素，选择距离3以内未被占用的格子移动，敌人触碰毒素受到4点伤害', expectedValues: { damage: 4 } }; }"
}
